# Xray Checker (Бета-версия)

[English](https://github.com/kutovoys/xray-checker) | [Russian](https://github.com/kutovoys/xray-checker/blob/main/README_RU.md)

## Обзор

Xray Checker — это бета-версия инструмента, предназначенного для тестирования соединений через различные протоколы, такие как VLESS, Trojan и Shadowsocks. Приложение парсит предоставленные конфигурации, создает файлы конфигурации для Xray и затем тестирует подключение через прокси Xray. Если внешний IP-адрес после использования прокси отличается от оригинального, инструмент отправляет результаты в систему мониторинга Uptime Kuma. В настоящее время поддерживается только Uptime Kuma, но в будущем будут добавлены дополнительные провайдеры.

Этот инструмент все еще находится в стадии разработки, и некоторые функции могут быть не полностью реализованы или стабильны. Мы будем рады вашим отзывам и вкладу в улучшение приложения.

## Возможности

- **Поддержка протоколов**: VLESS, Trojan и Shadowsocks.
- **Интеграция с провайдерами**: В настоящее время поддерживается Uptime Kuma, с планами добавить больше провайдеров.
- **Автоматическое тестирование**: Автоматически тестирует соединения и отправляет результаты в систему мониторинга.
- **Поддержка Docker**: Легко развертывается с использованием Docker и Docker Compose.

## Логика тестирования соединения

1. **Парсинг конфигурации**: Приложение парсит предоставленный файл конфигурации для извлечения деталей о тестируемых соединениях.
2. **Создание конфигураций Xray**: На основе полученных данных приложение создает файлы конфигурации для Xray.
3. **Проверка текущего внешнего IP**: Перед началом тестов приложение проверяет текущий внешний IP-адрес.
4. **Запуск Xray с каждой конфигурацией**: Xray запускается с каждым сгенерированным файлом конфигурации.
5. **Проверка IP через прокси Xray**: Внешний IP проверяется снова через прокси Xray, чтобы увидеть, отличается ли он от оригинального.
6. **Отправка данных в систему мониторинга**: Если IP-адреса отличаются, данные отправляются в систему Uptime Kuma.

## Как использовать

### Docker

Вы можете запустить Xray Checker с помощью Docker. Убедитесь, что у вас есть действительный файл `config.json`, содержащий ваши настройки подключения.

```bash
docker run --rm -v ./config.json:/app/config.json kutovoys/xray-checker
```

### Docker Compose

Для более сложных настроек или если вам нужно управлять несколькими сервисами, вы можете использовать Docker Compose. Пример файла docker-compose.yml:

```yaml
services:
  xray-checker:
    image: kutovoys/xray-checker
    container_name: xray-checker
    volumes:
      - ./config.json:/app/config.json
    restart: unless-stopped
```

Для запуска сервиса выполните команду:

```
docker-compose up -d
```

## Конфигурация

Приложению требуется файл config.json, который должен быть смонтирован в контейнер Docker. Этот файл должен содержать необходимую информацию о тестируемых соединениях, включая тип протокола, детали сервера и настройку мониторинга.

Пример файла конфигурации предоставлен в репозитории как config.json.example. Вы можете скопировать этот файл и изменить его в соответствии с вашими потребностями:

```json
{
  "provider": {
    "name": "uptime-kuma",
    "proxyStartPort": 10000,
    "interval": 40,
    "workers": 3,
    "configs": [
      {
        "link": "vless://uid@server:port?security=security&type=type&headerType=headerType&path=path&host=host&sni=sni&fp=fp&pbk=pbk&sid=#sid",
        "monitorLink": "https://uptime-kuma-url/api/push/MonitorID?status=up&msg=OK&ping="
      },
      {
        "link": "trojan://password@server:port?security=security&type=type&headerType=headerType&path=path&host=host&sni=sni&fp=fp#name",
        "monitorLink": "https://uptime-kuma-url/api/push/MonitorID?status=up&msg=OK&ping="
      },
      {
        "link": "ss://methodpassword@server:port#name",
        "monitorLink": "https://uptime-kuma-url/api/push/MonitorID?status=up&msg=OK&ping="
      }
    ]
  }
}
```

Просто переименуйте config.json.example в config.json и настройте значения в соответствии с вашими требованиями.

## Планы

- Prometheus-совместимый эндпоинт метрик

## Contributing

Так как это бета-версия, есть много возможностей для улучшения. Если вы столкнетесь с проблемами или у вас есть предложения, не стесняйтесь открыть issue или отправить pull request.

## Disclaimer

Это программное обеспечение все еще находится в разработке. Используйте его на свой страх и риск. Разработчики не несут ответственности за любые повреждения или проблемы, вызванные использованием этого инструмента.
